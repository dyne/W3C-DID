#!/bin/bash

service redis-server start
service nginx start

cat <<EOF | redis-cli
SET 'did:dyne:fabchain:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ' '{"id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","txid":"ad927b4481a86ffa1dca709e4b18133fffb07e92459560e327575c7ada6501c6"}'
EOF
cat <<EOF | redis-cli
SET 'did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ' '{"DID":{"@context":["https://www.w3.org/ns/did/v1","https://dyne.github.io/W3C-DID/specs/EcdsaSecp256k1_b64.json","https://w3id.org/security/suites/secp256k1-2020/v1","https://w3id.org/security/suites/ed25519-2018/v1"],"alsoKnownAs":"did:dyne:fabchain:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","verificationMethod":[{"controller":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ#key1","publicKeyBase64":"BGtt973mMgIwKWtoaBQgA26QEYwuIZ5rxPnbo7hkiECaWU1vojFdFlQlwkIIOMbPSkAfX3DBGBBzakLiMTcKpLQ=","type":"EcdsaSecp256k1VerificationKey_b64"},{"controller":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ#key_eddsa1","publicKeyBase58":"DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","type":"Ed25519VerificationKey2018"},{"blockchainAccountId":"eip155:1717658228:0xa576acebcb3f4f3b536f56ce5202896a89df41dc","controller":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ#fabchainAccountId","type":"EcdsaSecp256k1RecoveryMethod2020"}]},"alsoKnownAs":"did:dyne:fabchain:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","output":["All_writtend_on_chain_and_in_the_DID!"],"txidContainer":{"id":"did:dyne:controller:DwPLgTPBjVwDqoLQV8gbuCiTVEHrHMPmufn8T2DZwjRQ","txid":"ad927b4481a86ffa1dca709e4b18133fffb07e92459560e327575c7ada6501c6"}}'
EOF
cat <<EOF | redis-cli
SET 'did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE' '{"@context":["https://www.w3.org/ns/did/v1","https://dyne.github.io/W3C-DID/specs/EcdsaSecp256k1_b64.json","https://dyne.github.io/W3C-DID/specs/ReflowBLS12381_b64.json","https://dyne.github.io/W3C-DID/specs/SchnorrBLS12381_b64.json","https://dyne.github.io/W3C-DID/specs/Dilithium2_b64.json","https://w3id.org/security/suites/secp256k1-2020/v1","https://w3id.org/security/suites/ed25519-2018/v1",{"Country":"https://schema.org/Country","State":"https://schema.org/State","description":"https://schema.org/description","url":"https://schema.org/url"}],"Country":"ES","State":"NONE","alsoKnownAs":"did:dyne:fabchain:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE","description":"oracle-v.3","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE","proof":{"created":"1661515610351","jws":"eyJhbGciOiJFUzI1NksiLCJiNjQiOnRydWUsImNyaXQiOiJiNjQifQ..t8HF9yjQPywKLzk6_2OZyYKPnXRSTNAzAuMYF_E6jMi0YAa3mXkdeqRKqYgLwnYPnAFd1w7TRX6VCtrEcu3Cag","proofPurpose":"assertionMethod","type":"EcdsaSecp256k1Signature2019","verificationMethod":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M#key_ecdsa1"},"service":[{"id":"did:dyne:zenswarm-api#zenswarm-oracle-announce","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-announce","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#ethereum-to-ethereum-notarization.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/ethereum-to-ethereum-notarization.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-get-identity","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-get-identity","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-http-post","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-http-post","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-key-issuance.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-key-issuance.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-ping","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-ping","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#sawroom-to-ethereum-notarization.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/sawroom-to-ethereum-notarization.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-get-timestamp","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-get-timestamp","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-update","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-update","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-get-signed-timestamp","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-get-signed-timestamp","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-sign-dilithium","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-sign-dilithium","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-sign-ecdsa","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-sign-ecdsa","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-sign-eddsa","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-sign-eddsa","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-sign-schnorr","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-sign-schnorr","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-dilithium-signature-verification-on-planetmint.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-dilithium-signature-verification-on-planetmint.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-execute-zencode-planetmint.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-execute-zencode-planetmint.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-post-6-rand-oracles.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-post-6-rand-oracles.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-read-from-fabric","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-read-from-fabric","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-write-on-fabric","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-write-on-fabric","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-read-from-ethereum","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-read-from-ethereum","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-write-on-ethereum.chain","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-write-on-ethereum.chain","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-read-from-planetmint","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-read-from-planetmint","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-write-on-planetmint","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-write-on-planetmint","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-verify-dilithium","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-verify-dilithium","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-verify-ecdsa","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-verify-ecdsa","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-verify-eddsa","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-verify-eddsa","type":"LinkedDomains"},{"id":"did:dyne:zenswarm-api#zenswarm-oracle-verify-schnorr","serviceEndpoint":"https://swarm3.dyne.org:20004/api/zenswarm-oracle-verify-schnorr","type":"LinkedDomains"}],"url":"https://swarm3.dyne.org","verificationMethod":[{"controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#key_ecdsa1","publicKeyBase64":"BDUI06oUdBve7hbOqwgl4ApOVVYCMpJgiXuqfuM53sG2tjyylNCidbZHN2fGr4Q+FIe2nWFz624b2kOcv98yJIE=","type":"EcdsaSecp256k1VerificationKey_b64"},{"controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#key_reflow1","publicKeyBase64":"DSKH+yOXojJJlg7ycrf6hvliGC7h/Zn0yRFVEDZOmAfGjEBkMBwVnKkgOHtbSo8wFmBHTTaWV6BIFtxvp9IsPoR4XpdB3B1BAccGfr4O0Xp35l/qeQDQEAoD4Nt69LsRClR0Gvrpp6SoRW8ZQqKty4SDNgg3fHZAvcgFk6/gl66DgJ80XcJ/t7Qd+c9aCrK2CWHT8WwBBkDuA6ZUIoJgsnNo5LJJ5mQVtHibhoDBXtygYDcDOWUsLSmnHbhE7TVs","type":"ReflowBLS12381VerificationKey_b64"},{"controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#key_schnorr1","publicKeyBase64":"GB1BBaaltFOYPIgCnG0sHOin8CnQDx+2GXxRNCpG5yVejkcgHaW4RhgNT6dI6iRF","type":"SchnorrBLS12381VerificationKey_b64"},{"controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#key_dilithium1","publicKeyBase64":"ckaX29o5asGMCG08fJFNwI4xIJ4NOUtSR4UpfcK3ZHjk73boratRPBHsH+WlLgZX90RykhPQpnOVEHmkLpUGP5W1ZgnUhI3unyHb9WuPzMXjsRjB62mgfwrA8A8I9M3J5yXADndshAT1bO6oHz2N3jBiCEKhNE3WQ6ZLxX2JZiS9nmudqlIGjQzH9Wj6l1Vi8l/UscEdQep5alpUn70PXHl60z+qKoqPGBO+yCpEhMVaIbptXy2dtDs8E4eWMBlpDPnR1v51SCkSy+3C/PUDXZxikAzHGLGbB5GcK4dh2Lp4U5Ys896gm0FADf3GmgC+gwhpFLW6N2qAYaN7vEo/1zJfplnxKolPi+F60RPeW2qPGVeukwKp3VPsBfNgSJWXXeVJ4ALB4AYVcLUuc+jYM1ZPF0zJILoh+qI9hdaw2MTD4FPXAaw7mKxowVFMu3J5x+1oDe+beD/eZzKYRmzZsa6HbIFDgEPIa9s26RQ9Uj2v/RRzR+HQZOCWoPOXHv1dF2BV/0HKMgH45kYA5b4l1oqawE1oXZOKSux8hVgEwaEABka/dQ+5njVOesXphJnifrC/P/N3MCRdnw9/eINqnH1BtkrOsqUIpjFK8280micqJabd/sC+edDO+gwH3JZInh3lH8Fp6Hu5SJ1+DdOH/zIM6mmOdjwG3GFotWeXVfu57ix/VPlEzC6PcntO7iVFKPEjUnJ1KAlsONjJU+HljlVf2QmHAlec0encj5YKw/l7xNp6zmbgnnFUIo+zBkgho0BS4/RTOzBn+nsKyj9YDRl5CwhlFKdqPp8gyRaPD0UyiqTMrXZHW9lHX1M2HX84EEdo5mrSCY8v4yF2WO9+4aYpB7ZlGn0XIP9gWyajKa1tG7lRpP/1iAjMxpdsNbk4dSg1c//kYDoO3QTZkTmtWuLVS8ClQ5U11ScbbCLkd7t5B2T3p/LPcJ4y+lkWzVb9ZDkBeCQIb/tulxE7IA52uPrCb6aEe+qf1NlcvZzIjfek5omLasvn/AyfjLZxqUY6GUPWdnlpvWl6uAh7zQAZiG5CkS1hIL3bcPWeokJGloAxDWWHcUX/c0v/sMyFv9AwdK56q/GWWfEPz4xdG5wIgFxbkDjhoAT97WYscVlNwo/3UlB0T3YTuzxGvrUVdyY9UAQ4Ql7YkS4vDJLz/LAHdGIb/wIpq9PNxp/dTYN+dikijFbbmwzzoI6sTk/KE6igx1ebBm6HVrykIiyUkdYK45Ii7HjqwmSOnsOPP6dQCJdizyO+E2CD0YhJnkA3zw3HTVtj74JFRQzjNh7HwpT+TPTsPx6kvvubzMC2Y6Sa5GXDFlk2jBi0ggu7isrnKNpBSd39nW/mNZk/NcGVemTqv7EbhrOanSeKkjhDMuKa1+hE9+34IBnKk4A1G/U9Uh1WgkEnAo9Cyz2r6YxxuYmZWCq8Na68IQuGNb2lSepzR3WEkWsgz5knvwFOQAeJwbJ4QpzqEJnwYcN59hIeGjdBzBCrjzfATeatwZ/V8bZWe+QD+TONiFHXf39W2OHV8iaoja5hHnCyG2a1xgs+b5BlmjAULF1Wthgkf8QlxS4/MONGQ2+pgnd6LVIIAgjLViyCeyExMnvJhW0s/q4bgoULaj6NSUWzpXrAgMibRtB9EMcNK4C1C5yysUb8lWSnGy3OKZMnxltE21+uJJBN+47o1SIfHJNXobsIN6JBfchnCLyUx1IutwU/hHV+O1+FxCZbsdgxsxCk+fqAO98JiTqaHg==","type":"Dilithium2VerificationKey_b64"},{"controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#key_eddsa1","publicKeyBase58":"nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE","type":"Ed25519VerificationKey2018"},{"blockchainAccountId":"eip155:1717658228:0xd7f3693e784a049e3808e4c7b3133c96edd8954e","controller":"did:dyne:controller:7mz5RPAgbgHZtEBiVDy2gFaZMdPDTZsqJjLGuf8YXW1M","id":"did:dyne:id:nNer8S1CceT26TmBEA1u2kQSka6KTTRYMBqpwqhapQE#fabchainAccountId","type":"EcdsaSecp256k1RecoveryMethod2020"}]}'
EOF
mkdir -p /controller/contracts
cat <<EOF >/controller/contracts/keyring.json
{"Issuer":{"keyring":{"ecdh":"DyEkVdTrjTT4RTSYlSEiaVBcvDHSPhLoxsDgByS6seE=","eddsa":"C82mrqoeV7Jz1CPgefrARVXCjySK5WPmLkPoK7d85Njm","ethereum":"7cd0060d6656fa3ffc37b6160ba233e38f875036db148f7ac85bd34d47ce59d5"}}}
EOF
cd /controller && pm2 start && mkdir -p /root/.pm2/logs && tail -f /root/.pm2/logs/did-out.log
